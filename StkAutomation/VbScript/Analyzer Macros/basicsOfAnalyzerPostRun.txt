' THIS MACRO WILL BE EXECUTED FOR THE CURRENT STK SCENARIO
'
' Use this macro for any processing that needs to occur after each Scenario 
' run has completed during a Trade Study
'
'
' active=true
'
'
sub onPostRun()
 
dim stk
dim scen

' Change this value to change number of iterations Analyzer goes through before saving
runSaveVal = 5
 
'gets run number and sets values for next iteration
 
i = app.getValue("Model.STK.unsavedRuns")
i = i + 1
app.setValue"Model.STK.unsavedRuns",i
 
' checks run number to save after i number of runs since last saved
 
if i = runSaveVal then
 
               command = "Save / * "  & Chr(34) & "YourScenarioPath" & Chr(34)
               set stk = app.getComponent("Model.STK").userData

               app.setValue"Model.STK.unsavedRuns",0
               i = 0
               stk.ExecuteCommand(command)
              
end if

end sub
